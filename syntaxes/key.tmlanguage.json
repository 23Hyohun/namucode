{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Namuwiki Code",
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#links"
    },
    {
      "include": "#includes"
    },
    {
      "include": "#rubys"
    },
    {
      "include": "#anchors"
    },
    {
      "include": "#macros"
    },
    {
      "include": "#titles"
    },
    {
      "include": "#markups"
    },
    {
      "include": "#lists"
    },
    {
      "include": "#brackets"
    },
    {
      "include": "#footnotes"
    }
  ],
  "repository": {
    "comments": {
      "name": "comment.line.double-quote.namu",
      "match": "#{2,}.*"
    },
    "titles": {
      "name": "keyword.control.namu",
      "match": "(^== .* ==$|^=== .* ===$|^==== .* ====$|^===== .* =====$|^====== .* ======$)"
    },
    "links": {
      "match": "\\[\\[([^|\\]\\[]*)(\\|([^|\\]\\[]*))?\\]\\]",
      "captures": {
        "1": {
          "name": "string.quoted.double.namu"
        },
        "3": {
          "name": "support.constant.namu"
        }
      }
    },
    "includes": {
      "begin": "\\[(?=include)",
      "end": "\\]",
      "patterns": [
        {
          "name": "keyword.control.namu",
          "match": "include(?=\\(틀:)"
        },
        {
          "name": "variable.parameter.namu",
          "match": "틀:[^\\,|^\\)]*"
        },
        {
          "name": "variable.parameter.namu",
          "match": "(?<=,).[^,][^=]*(?=(=))"
        },
        {
          "name": "string.quoted.double.namu",
          "match": "(?<=\\=).[^,]*(?=(,|\\)))"
        }
      ]
    },
    "rubys": {
      "begin": "\\[(?=ruby)",
      "end": "\\]",
      "patterns": [
        {
          "name": "keyword.control.namu",
          "match": "ruby(?=\\()"
        },
        {
          "name": "string.quoted.double.namu",
          "match": "(?<=ruby\\().[^\\,]*(\\){1,})?(?=,)"
        },
        {
          "name": "variable.parameter.namu",
          "match": "(?<=\\,)[^\\=]*(?=\\=)"
        },
        {
          "name": "string.quoted.double.namu",
          "match": "(?<=ruby\\=)[^\\)\\]]*(\\){1,})?(?=\\)\\])"
        }
      ]
    },
    "anchors": {
      "begin": "\\[(?=(anchor|dday|age))",
      "end": "\\]",
      "patterns": [
        {
          "name": "keyword.control.namu",
          "match": "(anchor|dday|age)(?=\\()"
        },
        {
          "name": "variable.parameter.namu",
          "match": "(?<=(anchor|dday|age)\\().[^\\)]*(\\){1,})?(?=\\))"
        }
      ]
    },
    "macros": {
      "begin": "\\[(?=clearfix|date|datetime|목차|tableofcontents|각주|footnote|br)",
      "end": "\\]",
      "patterns": [
        {
          "name": "keyword.control.namu",
          "match": "clearfix|date|datetime|목차|tableofcontents|각주|footnote|br"
        }
      ]
    },
    "markups": {
      "patterns": [
        {
          "name": "markup.bold.namu",
          "match": "'''[^']*'''"
        },
        {
          "name": "markup.italic.namu",
          "match": "(''[^']*''|__[^_]*__)"
        },
        {
          "name": "markup.deleted.namu",
          "match": "~~[^~]*~~"
        },
        {
          "name": "keyword.control.namu",
          "match": "-{4,9}"
        },
        {
          "name": "keyword.operator.namu",
          "match": "^>"
        },
        {
          "name": "keyword.control.namu",
          "match": "\\|\\|"
        }
      ]
    },
    "lists": {
      "patterns": [
        {
          "name": "keyword.operator.namu",
          "match": "(?<=^ *)(\\*|1\\.|a\\.|A\\.|i\\.|I\\.(#[0-9][0-9])?)"
        }
      ]
    },
    "brackets": {
      "patterns": [
        {
          "name": "keyword.control.namu",
          "match": "{{{"
        },
        {
          "name": "support.constant.namu",
          "match": "(?<={{{)(\\+[0-9](?= )|#[A-Fa-f0-9]{3,6}(\\,#[A-Fa-f0-9]{3,6})?(?= )|(#!folding|#!wiki|#!html)(?= ))"
        },
        {
          "name": "string.quoted.double.namu",
          "match": "(?<=#!folding).*$"
        },
        {
          "match": "{{{#!wiki (style)=(\")([^\"]*)(\")",
          "captures": {
            "1": {
              "name": "string.quoted.double.namu"
            },
            "2": {
              "name": "string.quoted.double.namu"
            },
            "3": {
              "name": "meta.embedded.block.css"
            },
            "4": {
              "name": "string.quoted.double.namu"
            }
          }
        },
        {
          "name": "keyword.control.namu",
          "match": "}}}"
        }
      ]
    },
    "footnotes": {
      "patterns": [
        {
          "name": "string.quoted.double.namu",
          "match": "(?<=\\[)\\*([^ ]*)?(?=(]| ))"
        }
      ]
    }
  },
  "scopeName": "source.namu"
}
